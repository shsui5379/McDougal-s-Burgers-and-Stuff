<!DOCTYPE HTML>
	<html>
		<head>
			<link href="https://fonts.googleapis.com/css?family=Cherry+Cream+Soda&display=swap" rel="stylesheet">
			<title>McDougal's Burgers and Stuff Simulation</title>
			<style>
				h1, h2
				{
					text-align: center;
					font-weight: 300;
					font-family: "Cherry Cream Soda";
					color: #D50000;
				}
				h1
				{
					font-size: 62.5px;
				}
				h2
				{
					font-size: 39px;
					margin: 32px;
				}
				body
				{
					background-color: #FFCA28;
				}
				button
				{
					font: 18pt Tw Cen MT;
					color: white;
					background-color: #FF5252;
					box-shadow: 0px 3px 1px -2px rgba(0,0,0,.2), 0px 2px 2px 0px rgba(0,0,0,.14), 0px 1px 5px 0px rgba(0,0,0,.12);
					border-radius: 4px;
					border: none;
					height: 36px;
					padding: 0px 16px;
					margin: 8px 14px;
					outline: none;
				}
				button:hover
				{
					box-shadow: 0px 2px 4px -1px rgba(0,0,0,.2), 0px 4px 5px 0px rgba(0,0,0,.14), 0px 1px 10px 0px rgba(0,0,0,.12);
				}
				button:active
				{
					box-shadow: 0px 5px 5px -3px rgba(0,0,0,.2), 0px 8px 10px 1px rgba(0,0,0,.14), 0px 3px 14px 2px rgba(0,0,0,.12);
				}
			</style>
			<script>
				//menu items and costs
				const MENU = [
					[["Hamberger", 199], ["Chicken Sandwich", 199], ["Veggie Sandwich", 229]], //entrees
					[["French Fries", 99], ["Salad", 139], ["Cheese Sticks", 149], ["Rice", 119]], //sides
					[["Ice Cream", 189], ["Pie", 169], ["Cookie", 89]], //desserts
					[["Soda", 119], ["Bottled Water", 125], ["Juice", 169]] //drinks
				];

				const VALUES = [1, 5, 10, 25, 100, 500, 1000, 20000]; //values by position in wallet

				function initialize()
				{
					time = 180; //time left, in minutes
					receipts = []; //stores receipts
					registerBalance = [100, 40, 50, 40, 42, 4, 2, 0]; /*balance in the register.  
					format: pennies, nickels, dimes, quarters, 1, 5, 10, 20*/
					cashPay = [0, 0]; //tracks the amount of sales of each payment method.  format: amount paid, number of transations
					electronicPay = [0, 0];
					itemSales = [[0, 0, 0], [0, 0, 0, 0], [0, 0, 0], [0, 0, 0]]; /*number of sales of each item, grouped by type (en, si, de, dr)
					format: [hamburger, chicken, veggie], [fries, salad, cheese sticks, rice], [ice cream, pie, cookie], [soda, water, juice]*/
					if (typeof historyData == 'undefined')
					{
						historyData = []; //stores stats on history simulations
					}
					timeUpdater();
				}
				function timeUpdater() { //keeps track of time to determine if another order can be taken
					time -= randomNumber(1, 7);
					if (time > 0) {
						mealPickerOrder();
					} else {
						display();
					}
				}
				function mealPickerOrder() { //pick out the items from the menu to order
					var toOrder = [];
					var quantity = mealPickerQuantity();
					quantity.push(1); //+1 drink
					var prefix = ["en", "si", "de", "dr"]; //entree, side, dessert, drink prefix to identify item type on receipt
					for (var i = 0; i < quantity.length; i++) {
						for (var e = 0; e != quantity[i]; e++) {
							toOrder.push(prefix[i]+parseInt(randomNumber(0, MENU[i].length-1)));
						}
					}
					subtotalCalc(toOrder);
				}
				function mealPickerQuantity() { //determines how much of each to order
					var max = [1, 2, 1];
					var quantity = [];
					for (var maximum of max) {
						quantity.push(parseInt(randomNumber(0, maximum)));
					}
					return quantity;
				}
				function subtotalCalc(order) { //calculate subtotal given generated order
					var subtotal = 0;
					for (var food of order) {
						var submenu = submenuIdentifier(food);
						subtotal += MENU[submenu][parseInt(food[2])][1];
					}
					paymentMethodChooser(subtotal + taxCalc(subtotal));
				}
				function taxCalc(subtotal) { //returns amount of tax to pay
					return subtotal * 0.08875;
				}
				function paymentMethodChooser(cost) {
					if (Math.random() <= 0.4) { //40% of cash, 60% of credit
						cashPayment(cost);
					} else {
						creditPayment(cost);
					}
				}
				function cashPayment(cost) { //handles cash payments
					cashPay[0] += cost;
					cashPay[1]++;
					if (Math.random() <= 0.1) { //10% chance of paying exact change
						billsSplit("e", cost);
					} else {
						billsSplit(walletGenerator(), cost);
					}
				}
				function creditPayment(cost) { //handles credit payments
					electronicPay[0] += cost;
					electronicPay[1]++;
				}
				function walletGenerator() { //generates a wallet for the customer
					var wallet = [0, 0, 0, 0]; //wallet, in same format as registerBalance
					var max = [5, 3, 2];
					for (var i = 0; i < 3; i++) {
						wallet.push(parseInt(randomNumber(0, max[i])));
					}
					wallet.push(1);
					return wallet;
				}
				function billsSplit(wallet, cost) { //determines how a customer uses bills
					if (wallet == "e") { //exact change
						if (cost > 500) { //start with fives
							registerBalance[5]++;
							cost -= 500;
						}
						while (cost > 100) { //singles
							registerBalance[4]++;
							cost -= 100;
						}
						while (cost > 25) { //quarters
							registerBalance[3]++;
							cost -= 25;
						}
						while (cost > 10) { //dimes
							registerBalance[2]++;
							cost -= 10;
						}
						while (cost > 5) { //nickels
							registerBalance[1]++;
							cost -= 5;
						}
						registerBalance[0] += cost; //pennies
					} else { //nonexact change
						for (var i = 0; i < wallet.length; i++) {
							if (cost - wallet[i]*VALUES[i] > 0) {
								cost -= wallet[i]*VALUES[i];
								registerBalance[i] += wallet[i];
							} else {
								for (var e = 1; e < wallet[i]; e++) {
									if (cost - VALUES[i] > 0) {
										cost -= VALUES[i];
										registerBalance[i]++;
									}
								}
							}
						}
						if (cost != 0) { //giving change
							for (var a = 0; a < wallet.length; a++) {
								if (wallet[a] != 0) {
									a = 100;
									cost -= VALUES[a];
									cost *= -1;
									for (var b of registerBalance) {
										if (cost - registerBalance[i]*VALUES[i] > 0) {
										cost -= registerBalance[i]*VALUES[i];
										registerBalance[i] -= wallet[i];
									} else {
										for (var c = 1; c < registerBalance[i]; c++) {
											if (cost - VALUES[i] > 0) {
												cost -= VALUES[i];
												registerBalance[i]--;
											}
										}
									}
									}
								}
							}
						}
					}
					if (cost != 0) { //unable to give all change
						if (cost > 5) {
							for (var d = 0; d < wallet.length; d++) {
								if (wallet[d] != 0) {
									d = 100;
									registerBalance[d]--;
								}
							}
						} else {
							receiptGenerator();
						}
					} else {
						receiptGenerator();
					}
				}
				function receiptGenerator() {

				}
				function randomNumber(lower, upper)  //random number generator
                {
                    var multiplier = upper - lower + 1;
                    var rnd = (Math.random() * multiplier) + lower;
                    return rnd;
                }
				function submenuIdentifier(item) { //identify which section an item is on the menu
					var prefix = item.substring(0, 2);
					var section = 0;
					switch (true) {
						case prefix == "en":
							section = 0;
							break;
						case prefix == "si":
							section = 1;
							break;
						case prefix == "de":
							section = 2;
							break;
						case prefix == "dr":
							section = 3;
							break;
					}
					return section;
				}
				function display()
				{

				}
				function reset()
				{
					if(confirm("Are you sure you want to reset this data?  This cannot be undone."))
					{
						historyData = [];
						display();
					}
				}
			</script>
		</head>
			<h1>McDougal's Burgers and Stuff</h1>
			<h2>Simulation</h2>
			<button onclick = "initialize();">Start</button>
			<button onclick="reset();">Reset</button>
		</body>
	</html>